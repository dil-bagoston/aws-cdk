{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"0.0.0"},"children":{"destination-stack":{"id":"destination-stack","path":"destination-stack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"DeliveryBucketKey":{"id":"DeliveryBucketKey","path":"destination-stack/DeliveryBucketKey","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Key","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"destination-stack/DeliveryBucketKey/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{"enabled":true,"keyPolicy":{"Statement":[{"Action":"kms:*","Effect":"Allow","Principal":{"AWS":"arn:aws:iam::337909786053:root"},"Resource":"*"},{"Action":"kms:GenerateDataKey*","Condition":{"StringEquals":{"aws:SourceAccount":["12345678"]},"ArnLike":{"aws:SourceArn":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:12345678:delivery-source:*"]]}]}},"Effect":"Allow","Principal":{"Service":"delivery.logs.amazonaws.com"},"Resource":"*","Sid":"AWS CDK: Allow Logs Delivery to use the key"}],"Version":"2012-10-17"}}}}}},"DeliveryBucket":{"id":"DeliveryBucket","path":"destination-stack/DeliveryBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"destination-stack/DeliveryBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"aws:kms","kmsMasterKeyId":{"Fn::GetAtt":["DeliveryBucketKey146CC85D","Arn"]}}}]},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"destination-stack/DeliveryBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"destination-stack/DeliveryBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"DeliveryBucketA9AE6474"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["DeliveryBucketA9AE6474","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["DeliveryBucketA9AE6474","Arn"]},"/*"]]}]},{"Action":"s3:PutObject","Condition":{"StringEquals":{"s3:x-amz-acl":"bucket-owner-full-control","aws:SourceAccount":"12345678"},"ArnLike":{"aws:SourceArn":"arn:aws:logs:us-east-1:12345678:delivery-source:*"}},"Effect":"Allow","Principal":{"Service":"delivery.logs.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["DeliveryBucketA9AE6474","Arn"]},"/AWSLogs/12345678/*"]]}}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"destination-stack/DeliveryBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"0.0.0"},"children":{"Default":{"id":"Default","path":"destination-stack/DeliveryBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"0.0.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"destination-stack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"0.0.0"},"children":{"Staging":{"id":"Staging","path":"destination-stack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"0.0.0"}},"Role":{"id":"Role","path":"destination-stack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"0.0.0"}},"Handler":{"id":"Handler","path":"destination-stack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"0.0.0"}}}},"FirehoseBucket":{"id":"FirehoseBucket","path":"destination-stack/FirehoseBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"destination-stack/FirehoseBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"destination-stack/FirehoseBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"destination-stack/FirehoseBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FirehoseBucket407758F1"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["FirehoseBucket407758F1","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FirehoseBucket407758F1","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"destination-stack/FirehoseBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"0.0.0"},"children":{"Default":{"id":"Default","path":"destination-stack/FirehoseBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"0.0.0"}}}}}},"FirehoseRole":{"id":"FirehoseRole","path":"destination-stack/FirehoseRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"destination-stack/FirehoseRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"firehose.amazonaws.com"}}],"Version":"2012-10-17"},"policies":[{"policyName":"s3","policyDocument":{"Statement":[{"Action":"s3:PutObject","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FirehoseBucket407758F1","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}]}}}}},"DeliveryStream":{"id":"DeliveryStream","path":"destination-stack/DeliveryStream","constructInfo":{"fqn":"aws-cdk-lib.aws_kinesisfirehose.CfnDeliveryStream","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KinesisFirehose::DeliveryStream","aws:cdk:cloudformation:props":{"deliveryStreamEncryptionConfigurationInput":{"keyType":"AWS_OWNED_CMK"},"s3DestinationConfiguration":{"bucketArn":{"Fn::GetAtt":["FirehoseBucket407758F1","Arn"]},"bufferingHints":{"intervalInSeconds":10,"sizeInMBs":1},"roleArn":{"Fn::GetAtt":["FirehoseRoleAA67C190","Arn"]}},"tags":[{"key":"LogDeliveryEnabled","value":"true"}]}}},"S3DeliveryDestination":{"id":"S3DeliveryDestination","path":"destination-stack/S3DeliveryDestination","constructInfo":{"fqn":"@aws-cdk/mixins-preview.aws_logs.S3DeliveryDestination","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::DeliveryDestination","aws:cdk:cloudformation:props":{"deliveryDestinationPolicy":{"deliveryDestinationPolicy":{"Statement":[{"Action":"logs:CreateDelivery","Effect":"Allow","Principal":{"AWS":"arn:aws:iam::12345678:root"},"Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:337909786053:delivery-destination:*"]]}}],"Version":"2012-10-17"}},"deliveryDestinationType":"S3","destinationResourceArn":{"Fn::GetAtt":["DeliveryBucketA9AE6474","Arn"]},"name":"cdk-s3-S3DeliveryDestination-dest-destinationstack"}}},"FHDeliveryDestination":{"id":"FHDeliveryDestination","path":"destination-stack/FHDeliveryDestination","constructInfo":{"fqn":"@aws-cdk/mixins-preview.aws_logs.FirehoseDeliveryDestination","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::DeliveryDestination","aws:cdk:cloudformation:props":{"deliveryDestinationPolicy":{"deliveryDestinationPolicy":{"Statement":[{"Action":"logs:CreateDelivery","Effect":"Allow","Principal":{"AWS":"arn:aws:iam::12345678:root"},"Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:337909786053:delivery-destination:*"]]}}],"Version":"2012-10-17"}},"deliveryDestinationType":"FH","destinationResourceArn":{"Fn::GetAtt":["DeliveryStream","Arn"]},"name":"cdk-fh-FHDeliveryDestination-dest-destinationstack"}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"destination-stack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"destination-stack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"source-stack":{"id":"source-stack","path":"source-stack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"EventBus":{"id":"EventBus","path":"source-stack/EventBus","constructInfo":{"fqn":"aws-cdk-lib.aws_events.EventBus","version":"0.0.0"},"children":{"Resource":{"id":"Resource","path":"source-stack/EventBus/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnEventBus","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::EventBus","aws:cdk:cloudformation:props":{"logConfig":{"includeDetail":"NONE","level":"ERROR"},"name":"vended-logs-mixin-event-bus"}},"children":{"CDKSourceERROR_LOGSsourcestackEventBus5CCE9092":{"id":"CDKSourceERROR_LOGSsourcestackEventBus5CCE9092","path":"source-stack/EventBus/Resource/CDKSourceERROR_LOGSsourcestackEventBus5CCE9092","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnDeliverySource","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::DeliverySource","aws:cdk:cloudformation:props":{"logType":"ERROR_LOGS","name":"cdk-errorlogs-source-sourcestackEventBus5CCE9092","resourceArn":{"Fn::GetAtt":["EventBus7B8748AA","Arn"]}}}},"CdkDestsourcestacks3DestF499B7A7ErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9":{"id":"CdkDestsourcestacks3DestF499B7A7ErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9","path":"source-stack/EventBus/Resource/CdkDestsourcestacks3DestF499B7A7ErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9","constructInfo":{"fqn":"constructs.Construct","version":"10.4.5"},"children":{"Delivery":{"id":"Delivery","path":"source-stack/EventBus/Resource/CdkDestsourcestacks3DestF499B7A7ErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9/Delivery","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnDelivery","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::Delivery","aws:cdk:cloudformation:props":{"deliveryDestinationArn":"arn:aws:logs:us-east-1:337909786053:delivery-destination:cdk-s3-S3DeliveryDestination-dest-destinationstack","deliverySourceName":{"Ref":"EventBusCDKSourceERRORLOGSsourcestackEventBus5CCE9092B0479940"}}}}}},"CdkDestsourcestackFhDest056D7D0DErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9":{"id":"CdkDestsourcestackFhDest056D7D0DErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9","path":"source-stack/EventBus/Resource/CdkDestsourcestackFhDest056D7D0DErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9","constructInfo":{"fqn":"constructs.Construct","version":"10.4.5"},"children":{"Delivery":{"id":"Delivery","path":"source-stack/EventBus/Resource/CdkDestsourcestackFhDest056D7D0DErrorLogsDeliverysourcestackEventBus5CCE9092sourcestackEventBusCDKSourceERRORLOGSsourcestackEventBus5CCE909246DED3B9/Delivery","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnDelivery","version":"0.0.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::Delivery","aws:cdk:cloudformation:props":{"deliveryDestinationArn":"arn:aws:logs:us-east-1:337909786053:delivery-destination:cdk-fh-FHDeliveryDestination-dest-destinationstack","deliverySourceName":{"Ref":"EventBusCDKSourceERRORLOGSsourcestackEventBus5CCE9092B0479940"}}}}}}}}}},"s3Dest":{"id":"s3Dest","path":"source-stack/s3Dest","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0"}},"FhDest":{"id":"FhDest","path":"source-stack/FhDest","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"0.0.0"}},"BootstrapVersion":{"id":"BootstrapVersion","path":"source-stack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"source-stack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}},"DeliveryTest":{"id":"DeliveryTest","path":"DeliveryTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTest","version":"0.0.0"},"children":{"DefaultTest":{"id":"DefaultTest","path":"DeliveryTest/DefaultTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTestCase","version":"0.0.0"},"children":{"Default":{"id":"Default","path":"DeliveryTest/DefaultTest/Default","constructInfo":{"fqn":"constructs.Construct","version":"10.4.5"}},"DeployAssert":{"id":"DeployAssert","path":"DeliveryTest/DefaultTest/DeployAssert","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"0.0.0"},"children":{"BootstrapVersion":{"id":"BootstrapVersion","path":"DeliveryTest/DefaultTest/DeployAssert/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"0.0.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"DeliveryTest/DefaultTest/DeployAssert/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"0.0.0"}}}}}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.5"}}}}}